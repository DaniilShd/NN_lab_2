# Лабораторная работа №2 
Автор: Шайдуров Даниил Сергеевич

В лабораторной работе рассмотрено три нейронные сети: простая сверточная сеть, ResNet, MobileNet. 

Для ответов на вопросы принята простая кастомная нейронная сеть (simple_cnn). Обучена на датасете MNIST.

# Анализ графа вычислений в Netron

## 1 Свёрточные слои (Conv2d)

В качестве примера принят слой conv2. 

![conv2](https://github.com/DaniilShd/NN_lab_2/blob/main/images/conv2)

    in_channels = 32

    out_channels = 64

    kernel_size = 3x3 

    padding = 1

## 2 Общее количество слоёв

Модель состоит из 9 слоёв (не считая активации и dropout):

    Conv2d(1, 32)

    BatchNorm2d(32)

    MaxPool2d(2)

    Conv2d(32, 64)

    BatchNorm2d(64)

    MaxPool2d(2)

    Conv2d(64, 128)

    BatchNorm2d(128)

    MaxPool2d(2)

    Linear(128*3*3, 256)

    Linear(256, 10)

## 3 Структура графа модели

![onnx](https://github.com/DaniilShd/NN_lab_2/blob/main/images/onnx)

# Контрольные вопросы

## 1 Сколько параметров содержится в каждом свёрточном слое?
Параметры свёрточного слоя рассчитываются по формуле:
(kernel_width * kernel_height * in_channels + 1 (bias)) * out_channels

    conv1: (3×3×1 + 1) × 32 = 320 параметров

    conv2: (3×3×32 + 1) × 64 = 18,496 параметров

    conv3: (3×3×64 + 1) × 128 = 73,856 параметров

## 2 Как влияет MaxPool2d на размер выходного тензора?

MaxPool2d с размером ядра 2 уменьшает пространственные размеры (высоту и ширину) тензора в 2 раза. Например, если входной тензор имеет размер (32, 128, 128), то после MaxPool2d(2) он станет (32, 64, 64).

## 3 Что произойдёт при изменении количества выходных каналов в первом Conv2d?

Изменится количество выходных карт признаков (out_channels).

Это повлияет на вход следующего слоя (conv2.in_channels), который должен быть равен conv1.out_channels.

Также изменится число параметров в conv1, bn1 и последующих слоях.

## 4 Чем отличается eval() от train() режимов в PyTorch?

train(): Включает обучение (активирует Dropout, BatchNorm использует статистику текущего батча).
eval(): Отключает обучение (выключает Dropout, BatchNorm использует сохранённую статистику).


## 5 Какие преимущества даёт экспорт в формат ONNX?

Совместимость: Модель можно запускать в разных фреймворках (TensorFlow, MXNet и др.).

Оптимизация: Поддержка ускорения на специализированных устройствах (Intel OpenVINO, NVIDIA TensorRT).

Продуктивность: Упрощает деплой в production (например, для мобильных приложений или веб-сервисов).
